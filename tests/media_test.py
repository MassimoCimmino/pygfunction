"""
Test suite for media module.
"""
import pytest

import numpy as np

import pygfunction as gt

# =============================================================================
# Test media.Fluid.density
# =============================================================================
# Test values for various fluid types
@pytest.mark.parametrize("fluid_str, percent, temperature, expected", [
    ('Water', 0, 10, 999.7024701877426),
    ('Water', 0, 20, 998.2071504679284),
    ('Water', 0, 30, 995.6494539376417),
    ('MPG', 10, 10, 1008.2689961144661),
    ('MPG', 20, 10, 1017.8626755236311),
    ('MPG', 30, 10, 1028.0353104757783),
    ('MPG', 10, 20, 1006.2031746231479),
    ('MPG', 20, 20, 1014.7765850357973),
    ('MPG', 30, 20, 1023.7849656966808),
    ('MPG', 10, 30, 1003.2180687671566),
    ('MPG', 20, 30, 1010.9146187811484),
    ('MPG', 30, 30, 1018.8901487312302),
    ('MEG', 10, 10, 1012.5172712114797),
    ('MEG', 20, 10, 1026.9421864291571),
    ('MEG', 30, 10, 1041.81268177996),
    ('MEG', 10, 20, 1010.5788992741457),
    ('MEG', 20, 20, 1024.103841343761),
    ('MEG', 30, 20, 1038.0455069991867),
    ('MEG', 10, 30, 1007.8419592934212),
    ('MEG', 20, 30, 1020.5803239949098),
    ('MEG', 30, 30, 1033.6985710696938),
    ('MMA', 10, 10, 983.4613095855294),
    ('MMA', 20, 10, 970.003514932995),
    ('MMA', 30, 10, 956.0807785917889),
    ('MMA', 10, 20, 981.5369754807216),
    ('MMA', 20, 20, 966.7850160911171),
    ('MMA', 30, 20, 951.4780716051396),
    ('MMA', 10, 30, 978.6950827803122),
    ('MMA', 20, 30, 962.8970357199569),
    ('MMA', 30, 30, 946.4163175698473),
    ('MEA', 10, 10, 984.0169755411894),
    ('MEA', 20, 10, 972.8211726834397),
    ('MEA', 30, 10, 959.7917807305605),
    ('MEA', 10, 20, 981.8412262139618),
    ('MEA', 20, 20, 968.916073316228),
    ('MEA', 30, 20, 954.0145656811119),
    ('MEA', 10, 30, 978.6675214044719),
    ('MEA', 20, 30, 964.1970327636251),
    ('MEA', 30, 30, 947.7162326339673),
    ])
def test_media_density(fluid_str, percent, temperature, expected):
    f = gt.media.Fluid(fluid_str, percent, temperature).fluid
    val = f.density(temperature)
    print(val)
    assert np.isclose(val, expected, rtol=1e-03)


# =============================================================================
# Test media.Fluid.dynamic_viscosity
# =============================================================================
# Test values for various fluid types
@pytest.mark.parametrize("fluid_str, percent, temperature, expected", [
    ('Water', 0, 10, 0.0013058996603510726),
    ('Water', 0, 20, 0.0010015961431205946),
    ('Water', 0, 30, 0.0007972217998101543),
    ('MPG', 10, 10, 0.0019355497519401303),
    ('MPG', 20, 10, 0.0028747158905815936),
    ('MPG', 30, 10, 0.00443842147028475),
    ('MPG', 10, 20, 0.0014322654827054425),
    ('MPG', 20, 20, 0.002030081218434552),
    ('MPG', 30, 20, 0.0029649755163276424),
    ('MPG', 10, 30, 0.0011051906819817174),
    ('MPG', 20, 30, 0.0015077789197685406),
    ('MPG', 30, 30, 0.002104117057953085),
    ('MEG', 10, 10, 0.0016939732838861141),
    ('MEG', 20, 10, 0.00225040111095906),
    ('MEG', 30, 10, 0.002982996578124414),
    ('MEG', 10, 20, 0.001274521897582636),
    ('MEG', 20, 20, 0.001662420238542368),
    ('MEG', 30, 20, 0.00216644950875951),
    ('MEG', 10, 30, 0.0009944915473250838),
    ('MEG', 20, 30, 0.0012758690228681718),
    ('MEG', 30, 30, 0.0016388861877625733),
    ('MMA', 10, 10, 0.0017708773222801532),
    ('MMA', 20, 10, 0.0022114629278959376),
    ('MMA', 30, 10, 0.0024870362888294874),
    ('MMA', 10, 20, 0.001307290166958664),
    ('MMA', 20, 20, 0.001597900499247394),
    ('MMA', 30, 20, 0.0017888114211552148),
    ('MMA', 10, 30, 0.00100825619191877),
    ('MMA', 20, 30, 0.0012062505542303364),
    ('MMA', 30, 30, 0.001339885184111998),
    ('MEA', 10, 10, 0.0021531435266206062),
    ('MEA', 20, 10, 0.0032236607038786053),
    ('MEA', 30, 10, 0.004052953292713285),
    ('MEA', 10, 20, 0.0015286945963484458),
    ('MEA', 20, 20, 0.0021647586328195655),
    ('MEA', 30, 20, 0.0026599348716473225),
    ('MEA', 10, 30, 0.0011513482333395681),
    ('MEA', 20, 30, 0.0015533858907404473),
    ('MEA', 30, 30, 0.0018617799374801788),
    ])
def test_media_dynamic_viscosity(fluid_str, percent, temperature, expected):
    f = gt.media.Fluid(fluid_str, percent, temperature).fluid
    val = f.viscosity(temperature)
    print(val)
    assert np.isclose(val, expected, rtol=1e-03)

# =============================================================================
# Test media.Fluid.specific_heat
# =============================================================================
# Test values for various fluid types
@pytest.mark.parametrize("fluid_str, percent, temperature, expected", [
    ('Water', 0, 10, 4195.1588859665535),
    ('Water', 0, 20, 4184.050924523541),
    ('Water', 0, 30, 4179.819671974329),
    ('MPG', 10, 10, 4066.567327841638),
    ('MPG', 20, 10, 3956.0750111945817),
    ('MPG', 30, 10, 3829.9067044799335),
    ('MPG', 10, 20, 4076.3409907783143),
    ('MPG', 20, 20, 3976.7687703765587),
    ('MPG', 30, 20, 3857.0040104952327),
    ('MPG', 10, 30, 4087.9816766536514),
    ('MPG', 20, 30, 3997.8176072927586),
    ('MPG', 30, 30, 3883.8644060855163),
    ('MEG', 10, 10, 4040.5254141929463),
    ('MEG', 20, 10, 3878.2960125648947),
    ('MEG', 30, 10, 3688.510077929425),
    ('MEG', 10, 20, 4045.8587434905658),
    ('MEG', 20, 20, 3896.1986036794215),
    ('MEG', 30, 20, 3718.2510136895853),
    ('MEG', 10, 30, 4053.0708838851647),
    ('MEG', 20, 30, 3914.3988378361287),
    ('MEG', 30, 30, 3747.227085473126),
    ('MMA', 10, 10, 4219.150837041468),
    ('MMA', 20, 10, 4095.282694548098),
    ('MMA', 30, 10, 3938.189018136434),
    ('MMA', 10, 20, 4197.520573446068),
    ('MMA', 20, 20, 4110.081977854491),
    ('MMA', 30, 20, 3986.47248195434),
    ('MMA', 10, 30, 4177.092917070355),
    ('MMA', 20, 30, 4111.367048690323),
    ('MMA', 30, 30, 4012.7465102530355),
    ('MEA', 10, 10, 4350.572772963351),
    ('MEA', 20, 10, 4348.84164200469),
    ('MEA', 30, 10, 4192.58929019259),
    ('MEA', 10, 20, 4303.290975720076),
    ('MEA', 20, 20, 4328.658186319545),
    ('MEA', 30, 20, 4216.106493272698),
    ('MEA', 10, 30, 4272.1999935948015),
    ('MEA', 20, 30, 4316.492002673067),
    ('MEA', 30, 30, 4237.636742030536),
    ])
def test_media_specific_heat(fluid_str, percent, temperature, expected):
    f = gt.media.Fluid(fluid_str, percent, temperature).fluid
    val = f.specific_heat(temperature)
    print(val)
    assert np.isclose(val, expected, rtol=1e-03)

# =============================================================================
# Test media.Fluid.conductivity
# =============================================================================
# Test values for various fluid types
@pytest.mark.parametrize("fluid_str, percent, temperature, expected", [
    ('Water', 0, 10, 0.5787774010063071),
    ('Water', 0, 20, 0.598012355523438),
    ('Water', 0, 30, 0.6143922004176029),
    ('MPG', 10, 10, 0.5300549191212082),
    ('MPG', 20, 10, 0.4817771638791716),
    ('MPG', 30, 10, 0.4364029024368229),
    ('MPG', 10, 20, 0.5438139911581278),
    ('MPG', 20, 20, 0.4922134827182714),
    ('MPG', 30, 20, 0.4444288290269426),
    ('MPG', 10, 30, 0.5567347918108109),
    ('MPG', 20, 30, 0.5023926225745958),
    ('MPG', 30, 30, 0.45249493969037613),
    ('MEG', 10, 10, 0.5386105756160928),
    ('MEG', 20, 10, 0.496163218175526),
    ('MEG', 30, 10, 0.4555075172982103),
    ('MEG', 10, 20, 0.5528914770740265),
    ('MEG', 20, 20, 0.5076648341960951),
    ('MEG', 30, 20, 0.46489722365425923),
    ('MEG', 10, 30, 0.5661284239440396),
    ('MEG', 20, 30, 0.5186388785688518),
    ('MEG', 30, 30, 0.4740758190744439),
    ('MMA', 10, 10, 0.524298461828551),
    ('MMA', 20, 10, 0.472828484961337),
    ('MMA', 30, 10, 0.4245836511047557),
    ('MMA', 10, 20, 0.5384009760509022),
    ('MMA', 20, 20, 0.48338652493545536),
    ('MMA', 30, 20, 0.43210259145515517),
    ('MMA', 10, 30, 0.5517880546574834),
    ('MMA', 20, 30, 0.49377897672944504),
    ('MMA', 30, 30, 0.43976400834470714),
    ('MEA', 10, 10, 0.515765397272651),
    ('MEA', 20, 10, 0.4570562191793063),
    ('MEA', 30, 10, 0.4041064846449754),
    ('MEA', 10, 20, 0.5285242624873144),
    ('MEA', 20, 20, 0.466309950353855),
    ('MEA', 30, 20, 0.41070731333976634),
    ('MEA', 10, 30, 0.5408859303860871),
    ('MEA', 20, 30, 0.47546296088655077),
    ('MEA', 30, 30, 0.4172233323372221),
    ])
def test_media_conductivity(fluid_str, percent, temperature, expected):
    f = gt.media.Fluid(fluid_str, percent, temperature).fluid
    val = f.conductivity(temperature)
    print(val)
    assert np.isclose(val, expected, rtol=5e-03)
